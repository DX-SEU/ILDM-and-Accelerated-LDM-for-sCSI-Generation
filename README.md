# Accelerated LDM-Enabled Digital Twin of Channel for Massive MIMO Statistical CSI Generation

This is the repository for our paper **Accelerated LDM-Enabled Digital Twin of Channel for Massive MIMO Statistical CSI Generation**

## Key Features

We propose the improved latent diffusion model (ILDM) and its accelerated version named the accelerated LDM, variants of LDM and DDIM specified for precise channel data generation. While standard diffusion models emphasize sample diversity and perceptual realism (e.g., image generation), our work focuses on the accuracy and fidelity of generated data with respect to real-world wireless channel distributions. Given a  2D position coordinate, ILDM generates the statistical channel state information (sCSI).



## Quick Start

### Installation

#### Create a conda environment and install

```python
conda create -n ildm python=2.9
conda activate ildm
pip install tensorflow==2.6.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
pip install keras==2.6.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
pip install protobuf==3.20 -i https://pypi.tuna.tsinghua.edu.cn/simple
pip install matplotlib==3.3.3 -i https://pypi.tuna.tsinghua.edu.cn/simple
pip install scipy==1.10.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
```

#### Other dependencies

```python
pip install h5py
pip install numpy==1.19.5
```

### Data Preparation

1. Download the [QuaDRiGa]([QuaDRiGa](https://quadriga-channel-model.de/)) to generate the sCSI dataset.
2. Place the downloaded **quadriga_src** folder in the same-level directory of **GenDataset.m**
3. Run **GenDataset.m** to generate the training dataset and test dataset of VAE as **ADCPMTrain.mat** and **ADCPMTest.mat**, as well as the corresponding 2D position coordinate data **trainLoc.mat** and **testLoc.mat**. Note that training VAE only need **ADCPMTrain.mat**.
4. The training dataset of ILDM is generated by **sampleVAE.py**.

### Training Stage

1. Run **trainVAE.py**, and the checkpoint files are saved in **ckpt_file/VAE64**.
2. Run **sampleVAE.py** to generate the training dataset of ILDM.
3. Run **trainILDM.py**, and the checkpoint files are saved in **ckpt_file/ILDM**.

### Generation Stage

- ILDM: Run **sampleILDM.py**.
- Accelerated ILDM: Run **sampleALDM.py**.

## Citation

If you find our work useful in your research, please consider citing:

