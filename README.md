# Accelerated LDM-Enabled Digital Twin of Channel for Massive MIMO Statistical CSI Generation

This is the repository for our paper **Accelerated LDM-Enabled Digital Twin of Channel for Massive MIMO Statistical CSI Generation**

## Key Features

We propose the improved latent diffusion model (ILDM) and its accelerated version named the accelerated LDM, variants of LDM and DDIM specified for precise channel data generation. While standard diffusion models emphasize sample diversity and perceptual realism (e.g., image generation), our work focuses on the accuracy and fidelity of generated data with respect to real-world wireless channel distributions. Given a  2D position coordinate, ILDM generates the statistical channel state information (sCSI).



## Quick Start

### Installation

```python
conda create -n ildm python=3.8.20
conda activate ildm
pip install tensorflow==2.6.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
pip install keras==2.6.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
pip install protobuf==3.20 -i https://pypi.tuna.tsinghua.edu.cn/simple
pip install matplotlib==3.3.3 -i https://pypi.tuna.tsinghua.edu.cn/simple
pip install scipy==1.10.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
```


### Data Preparation

1. Download the [QuaDRiGa](https://quadriga-channel-model.de/) to generate the sCSI dataset.
2. Place the downloaded **quadriga_src** folder in the same-level directory of **GenDataset.m**
3. Run **GenDataset.m** to generate the training dataset and test dataset of VAE as **ADCPMTrain.mat** and **ADCPMTest.mat**, as well as the corresponding 2D position coordinate data **trainLoc.mat** and **testLoc.mat**. Note that training VAE only need **ADCPMTrain.mat**.
4. The training dataset of ILDM is generated by **sampleVAE.py**.

### Training Stage

1. Run **trainVAE.py**, and the checkpoint files are saved in **ckpt_file/VAE64**.
2. Run **sampleVAE.py** to generate the training dataset of ILDM.
3. Run **trainILDM.py**, and the checkpoint files are saved in **ckpt_file/ILDM**.

### Generation Stage

- ILDM: Run **sampleILDM.py**.
- Accelerated ILDM: Run **sampleALDM.py**.

### Our Dataset and Model Checkpoints
1. Dataset: https://huggingface.co/datasets/DX-SEU/sCSI/tree/main.
2. VAE Model Weights: https://huggingface.co/DX-SEU/VAE64/tree/main.
3. ILDM Model Weigths: https://huggingface.co/DX-SEU/ILDM/tree/main.

## Citation

If you find our work useful in your research, please consider citing:
```python
@ARTICLE{11247875,
  author={Dong, Xu and Gong, Xinrui and Lu, An-An and Gao, Xiqi and Xia, Xiang-Gen and Zeng, Yong and Wang, Cheng-Xiang},
  journal={IEEE Transactions on Wireless Communications}, 
  title={Accelerated LDM-Enabled Digital Twin of Channel for Massive MIMO Statistical CSI Generation}, 
  year={2025},
  volume={},
  number={},
  pages={1-1},
  keywords={Digital twins;Diffusion models;Generative AI;6G mobile communication;Physical layer;Massive MIMO;Integrated sensing and communication;Wireless communication;Vectors;Diffusion processes;Integrated sensing and communication;digital twin of channel;improved latent diffusion model;accelerated LDM;sCSI generation},
  doi={10.1109/TWC.2025.3629739}}
